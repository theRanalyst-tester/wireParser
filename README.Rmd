#### Overview
The wireParser app is an attempt at automating the scheduling of financial wire transfer documents that are received when a bank or other financial instutition is subpoenaed. An analyst can take hours, or even days, to enter all of the data from these documents in an Excel spreadsheet for further analysis. With this tool, that scheduling happens almost instantly, which allows more time for actual analysis. 

#### How to Use the App
**First and foremost, you need to have R and RStudio installed. If you do not have these things installed, please Google how to do this. In addition, you will need to install poppler utils. You can Google "pdftotext" to find a file from which to download.**

Using this tool is very straightforward, you simply need to call the `parseWireData()` function and pass it three arguments: `file`, `bank`, and `format`. The `file` argument tells R which file you'd like to parse, `bank` indicates the bank from which the file came, and `format` indicates the file type (i.e., xlsx, pdf, or csv). There is an additional fourth paramater, `skip`, which has a default value of 0. This paramater only needs to be changed if you're parsing an Excel document or CSV file **and** want to skip a number of rows in the spreadsheet. Lastly, the fifth parameter `password` can be used if you have an Excel file that is password protected.

Once the app is finished parsing the file, a `data.frame` object is returned with the relevant information from the document. In the future, I'll be looking to add a spreadsheet with every known bank geocoded, both national and international. This will allow the app to automatically geolocate any and all banks involved, which will allow the analyst to map the flow of funds. Below is the list of banks (in alphabetical order) currently accepted and how to work with each one.

#### Bank of America
Bank of America typically sends their compliance via PDFs. These files are easy for you to parse as all you need to pass is the path to the PDF file. One thing to be wary of, however, is the fact that this function relies on OCR, which means you should check to ensure all of your numbers were transcribed correctly. Aside from this, Bank of America parsing should give you little to not trouble. In addition, I have had limited samples from which to identify patterns in BoA's output. You should pay special attention to the flow of funds in the parsed output and ensure it is what you expected.

#### Capital One
Capital One sends PDF files that are very easy to parse. With the exception of OCR errors (i.e. an "l" instead of a "1"), there should be little to no errors from Capital One parsing.

#### Citibank
Citibank sends Excel files (xls or xlsx) that are, for the most part, already parsed. The largest concern with Citibank is that at times they will leave a field blank, such as Originating Bank, as a means to imply that it is Citibank that should be in that field. The parser makes an effort to fill in the holes for you and properly identify the flow of funds. The function assumes that there is only one sheet in the workbook (if there are more than one it will read the first sheet) and that the first row of data is **not** the headers. It actually looks on line two for the variable names. It also assumes that only the first 12 columns are of value and ignores the others. 

#### HSBC
HSBC sends their files in Excel format (xls or xlsx) that are difficult to decipher. The `parseHSBC` function makes a strong effort to properly identify all of the relelvant information and the true path of money, but it is strongly encouraged to review all output produced from this function. This function assumes that there are multiple sheets in the workbook and will look for a workbook named "Details". If it cannot find a sheet named "Details" it will ask you what the sheet name is. 

#### Shortcomings
Parsing dynamic objects is rarely perfect. There will inevitably be errors, inaccuracies, and other oddities. In this case, please file an issue via [this link](https://github.com/theRanalyst/wireParser/issues) and I will try to address the issue as soon as possible. Please note that issues you file may be difficult to address because errors cannot be reproduced with your documents due to the confidentiality. Please be patient.
